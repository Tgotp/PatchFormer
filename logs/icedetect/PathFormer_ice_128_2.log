Args in experiment:
Namespace(is_training=1, model='PathFormer', model_id='128_2', data='Icing_128_20/', data_path='./data/Graph_BladeIcing/', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=128, pred_len=2, individual=False, d_model=8, d_ff=64, num_nodes=26, layer_nums=1, k=2, num_experts_list=[4, 4, 4], patch_size_list=[16, 4, 8, 32, 2], do_predict=False, revin=1, drop=0.1, embed='timeF', residual_connection=1, metric='mae', num_workers=10, itr=1, train_epochs=30, batch_size=64, patience=10, learning_rate=0.001, lradj='TST', use_amp=False, pct_start=0.4, use_gpu=True, gpu=0, use_multi_gpu=False, devices='2', test_flop=False)
USE GPU: cuda:0
x.shape torch.Size([7010, 128, 26])
x.shape torch.Size([2434, 128, 26])
Epoch #1:
	iters: 100, epoch: 1 | loss: 0.5113199
	speed: 0.1972s/iter; left time: 630.8832s
Epoch: 1 cost time: 21.620418787002563
Epoch: 1, Steps: 110 | Train Loss: 0.6093611 Test Loss: 0.7043438 | Train Accuracy: 0.6718973 Vali Accuracy: 0.6064092
Validation loss decreased (inf --> 0.704344).  Saving model ...
Updating learning rate to 5.638027070978594e-05
Epoch #2:
	iters: 100, epoch: 2 | loss: 0.2796978
	speed: 0.2268s/iter; left time: 700.7792s
Epoch: 2 cost time: 20.362537145614624
Epoch: 2, Steps: 110 | Train Loss: 0.3974786 Test Loss: 0.9926674 | Train Accuracy: 0.8343795 Vali Accuracy: 0.5649137
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00010440311088695292
Epoch #3:
	iters: 100, epoch: 3 | loss: 0.1521576
	speed: 0.2270s/iter; left time: 676.3277s
Epoch: 3 cost time: 20.29148006439209
Epoch: 3, Steps: 110 | Train Loss: 0.2434669 Test Loss: 1.0243647 | Train Accuracy: 0.9225392 Vali Accuracy: 0.5936730
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000180790907521689
Epoch #4:
	iters: 100, epoch: 4 | loss: 0.0771773
	speed: 0.2327s/iter; left time: 667.9917s
Epoch: 4 cost time: 20.767237186431885
Epoch: 4, Steps: 110 | Train Loss: 0.1436804 Test Loss: 1.7915528 | Train Accuracy: 0.9637660 Vali Accuracy: 0.5710764
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00028033010733149
Epoch #5:
	iters: 100, epoch: 5 | loss: 0.0334927
	speed: 0.2382s/iter; left time: 657.3168s
Epoch: 5 cost time: 21.44239377975464
Epoch: 5, Steps: 110 | Train Loss: 0.0641506 Test Loss: 2.6606252 | Train Accuracy: 0.9881598 Vali Accuracy: 0.5673788
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.00039622704765335573
Epoch #6:
	iters: 100, epoch: 6 | loss: 0.0138316
	speed: 0.2393s/iter; left time: 634.1421s
Epoch: 6 cost time: 21.53186535835266
Epoch: 6, Steps: 110 | Train Loss: 0.0262417 Test Loss: 3.5067585 | Train Accuracy: 0.9967190 Vali Accuracy: 0.5731306
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.0005205716315835028
Epoch #7:
	iters: 100, epoch: 7 | loss: 0.0029403
	speed: 0.2389s/iter; left time: 606.7497s
Epoch: 7 cost time: 21.449883937835693
Epoch: 7, Steps: 110 | Train Loss: 0.0126166 Test Loss: 4.3096075 | Train Accuracy: 0.9982882 Vali Accuracy: 0.5755957
EarlyStopping counter: 6 out of 10
Updating learning rate to 0.0006448772010132996
Epoch #8:
	iters: 100, epoch: 8 | loss: 0.1534748
	speed: 0.2484s/iter; left time: 603.6630s
Epoch: 8 cost time: 22.50064992904663
Epoch: 8, Steps: 110 | Train Loss: 0.1673342 Test Loss: 7.7244444 | Train Accuracy: 0.9456491 Vali Accuracy: 0.5723090
EarlyStopping counter: 7 out of 10
Updating learning rate to 0.0007606597606177704
Epoch #9:
	iters: 100, epoch: 9 | loss: 0.0424881
	speed: 0.2487s/iter; left time: 577.0989s
Epoch: 9 cost time: 22.455202102661133
Epoch: 9, Steps: 110 | Train Loss: 0.0453499 Test Loss: 6.9822145 | Train Accuracy: 0.9844508 Vali Accuracy: 0.5870994
EarlyStopping counter: 8 out of 10
Updating learning rate to 0.0008600170201061105
Epoch #10:
	iters: 100, epoch: 10 | loss: 0.0112053
	speed: 0.2564s/iter; left time: 566.5675s
Epoch: 10 cost time: 23.203384160995483
Epoch: 10, Steps: 110 | Train Loss: 0.0114117 Test Loss: 11.9646435 | Train Accuracy: 0.9971469 Vali Accuracy: 0.5628595
EarlyStopping counter: 9 out of 10
Updating learning rate to 0.0009361677344474805
Epoch #11:
	iters: 100, epoch: 11 | loss: 0.0007548
	speed: 0.2483s/iter; left time: 521.5229s
Epoch: 11 cost time: 22.3533296585083
Epoch: 11, Steps: 110 | Train Loss: 0.0032555 Test Loss: 12.3978233 | Train Accuracy: 0.9991441 Vali Accuracy: 0.5612161
EarlyStopping counter: 10 out of 10
Early stopping
